import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.mime.image import MIMEImage

# Step 1: Prepare the Image
with open("path_to_image.jpg", "rb") as img_file:
    msg_image = MIMEImage(img_file.read())
    msg_image.add_header('Content-ID', '<image1>')  # angle brackets are important
    img_file.close()

# Step 2: Craft the Email
msg = MIMEMultipart('related')
msg['From'] = 'your_email@example.com'
msg['To'] = 'recipient_email@example.com'
msg['Subject'] = 'Test Email with Inline Image'

# HTML body with a reference to the inline image using the CID we gave it
msg_text = MIMEText('<b>This is a test email</b><br><img src="cid:image1">', 'html')
msg.attach(msg_text)
msg.attach(msg_image)

# Step 3: Send the Email
with smtplib.SMTP('your.smtp.server', port) as server:
    server.login('your_email@example.com', 'your_password')
    server.sendmail('your_email@example.com', 'recipient_email@example.com', msg.as_string())
