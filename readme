@classmethod
    def get_latest_successful_runs(cls, rule_ids):
        from sqlalchemy import func, and_

        subquery = cls.query.with_entities(
            cls.run_dt,
            cls.rule_id,
            cls.sts_cd,
            cls.excp_cn,
            cls.scp_cn,
            cls.run_id,
            func.row_number().over(
                partition_by=[cls.rule_id, cls.sts_cd],
                order_by=cls.run_id.desc()
            ).label('row_num')
        ).filter(cls.sts_cd == 'SUCCESS').subquery()

        latest_successful_runs = db.session.query(subquery).filter(
            and_(
                subquery.c.row_num == 1,
                subquery.c.rule_id.in_(rule_ids)
            )
        ).all()

        return latest_successful_runs
