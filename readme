def get_unique_distributions_with_rule_ids():
    # Query to get all distribution IDs and their associated rule IDs
    distribution_data = db.session.query(
        YourTableName.DSTR_ID_TX,
        func.group_concat(YourTableName.RULE_ID).label('rule_ids')
    ).group_by(YourTableName.DSTR_ID_TX).all()

    # Formatting the result as a dictionary
    result = {dist_id: [int(rule_id) for rule_id in rule_ids.split(',')] for dist_id, rule_ids in distribution_data}
    return result

# Call the function
unique_distributions = get_unique_distributions_with_rule_ids()
print(unique_distributions)
