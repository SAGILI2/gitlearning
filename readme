# Assuming get_latest_successful_runs is a method that returns the latest runs for each rule_id
rule_ids = [2001, 2002, 2003]
latest_runs = RuleRunLogModel.get_latest_successful_runs(rule_ids)

# Calculate DQI on these latest runs
sum_excp_cn = 0
sum_scp_cn = 0

for run in latest_runs:
    if run.excp_cn is not None and run.scp_cn is not None:
        sum_excp_cn += run.excp_cn
        sum_scp_cn += run.scp_cn

# Avoid division by zero
dqi = sum_excp_cn / sum_scp_cn if sum_scp_cn > 0 else 0

# Now latest_runs can be serialized using RuleRunLogSchema
rule_run_log_schema = RuleRunLogSchema(many=True)
result = rule_run_log_schema.dump(latest_runs)

# 'result' now contains the serialized data
# 'dqi' contains the calculated Data Quality Index
