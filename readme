from sqlalchemy.orm import joinedload

@staticmethod
def get_profiling_results(profile_id):
    max_run_id = execute_raw_oracle(MAX_RUN_ID.format(profile_id=profile_id))
    if max_run_id := max_run_id.first()[0]:
        return (
            ProfileRsltsMastModel.query
            .options(joinedload('profile_categorical_col_stat').limit(10))
            .filter(
                ProfileRsltsMastModel.profile_id == profile_id,
                ProfileRsltsMastModel.run_id == max_run_id
            )
            .all()
        )
    else:
        return None
